# 证书查询系统部署指南

本文档提供了如何将证书查询系统部署到服务器的详细步骤。我们采用的是"本地构建，服务器部署"的方式，这种方式更加高效和安全。

## 前提条件

- 服务器已安装 Docker 和 Docker Compose
- 本地开发环境已安装 Node.js 和 npm

## 部署步骤

### 1. 在本地构建项目

```bash
# 进入项目目录
cd certificate-query

# 安装依赖
npm install

# 构建项目
npm run build
```

构建完成后，项目目录下会生成一个 `dist` 文件夹，包含所有编译好的静态文件。

### 2. 准备上传文件

您只需要将以下文件上传到服务器：

- `dist` 目录（构建好的静态文件）
- `Dockerfile`
- `nginx.conf`
- `docker-compose.yml`

### 3. 上传文件到服务器

```bash
# 在服务器上创建部署目录
ssh user@服务器IP "mkdir -p /path/to/certificate-deploy"

# 上传必要文件
scp -r dist Dockerfile nginx.conf docker-compose.yml user@服务器IP:/path/to/certificate-deploy/
```

### 4. 在服务器上部署

```bash
# 登录到服务器
ssh user@服务器IP

# 进入部署目录
cd /path/to/certificate-deploy

# 构建并启动Docker容器
docker-compose up -d
```

### 5. 验证部署

部署完成后，您可以通过服务器的IP地址或域名访问证书查询系统：

```
http://服务器IP
```

或者如果您配置了域名：

```
http://您的域名
```

## 更新应用

当您需要更新应用时，只需要重复上述步骤1-4即可。如果只是更新前端代码，您只需要重新构建并上传 `dist` 目录，然后重新构建Docker镜像：

```bash
# 在服务器上
cd /path/to/certificate-deploy
docker-compose down
docker-compose up -d --build
```

## 故障排除

如果您遇到问题，可以查看Docker容器的日志：

```bash
docker logs $(docker ps -q -f name=certificate-app)
```

## 注意事项

1. 确保在本地构建时使用了正确的环境变量（`.env.production`）
2. 如果API地址需要更改，可以修改 `.env.production` 文件中的 `VUE_APP_API_URL` 值，然后重新构建项目
3. 如果需要配置HTTPS，请修改 `nginx.conf` 文件并添加SSL证书配置